---
import Layout from "@/layouts/Layout.astro";
import Cta from "@/components/organisms/Cta.astro";
import Products from "@/components/Products.astro";
import { getI18N } from "@/a18n/index.ts";

const { currentLocale } = Astro;
const t = getI18N({ currentLocale: currentLocale ?? "es" });
---

<Layout title="Alquiler de equipos" pageColor="white">
  <section class="container mx-auto px-4 py-16">
    <h1
      class="text-5xl font-black leading-none text-balance italic uppercase"
      id="rental-title"
    >
      {t.RENTAL.TITLE}
    </h1>
    <p class="text-[38px]" id="rental-text">{t.RENTAL.TEXT}</p>
  </section>

  <Products />
  <Cta title={t.RENTAL.CTA} long />
</Layout>

<script>
  import gsap from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";
  import { SplitText } from "gsap/SplitText";
  gsap.registerPlugin(ScrollTrigger, SplitText);

  function initProductAnimations() {
    const productItems = document.querySelectorAll(".product-item");
    const productSection = document.getElementById("products");
    const title = document.getElementById("rental-title");
    const text = document.getElementById("rental-text");

    const titleSplit = SplitText.create(title, { type: "lines" });
    const textSplit = SplitText.create(text, { type: "lines" });

    gsap
      .timeline()
      .from(titleSplit.lines, {
        opacity: 0,
        y: 30,
        duration: 0.3,
        delay: 1,
        ease: "power2.out",
      })
      .from(textSplit.lines, {
        opacity: 0,
        y: 30,
        duration: 0.3,
        ease: "power2.out",
      });

    gsap.from(productItems, {
      opacity: 0,
      y: 100,
      duration: 0.2,
      ease: "power2.out",
      stagger: 0.1,
      scrollTrigger: {
        trigger: productSection,
        start: "-=200 center",
        end: "center -=300",
        toggleActions: "play reverse play reverse",
        scrub: 0.5,
      },
    });
  }

  document.addEventListener("DOMContentLoaded", initProductAnimations);
</script>
