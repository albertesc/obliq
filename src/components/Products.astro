---
import { products } from "@/data/products.json";
import { getI18N } from "@/a18n/index.ts";
import { getRelativeLocaleUrl } from "astro:i18n";
import Button from "@/components/atoms/Button.astro";

const { currentLocale } = Astro;
const t = getI18N({ currentLocale: currentLocale ?? "es" });
---

<section class="container mx-auto px-4 pt-16 relative" id="products">
  {
    products.map((product) => (
      <div class="grid grid-cols-1 md:grid-cols-[25%_1fr] gap-0 md:gap-14 mb-6 md:mb-14 border-b border-gray-300 pb-0 md:pb-14 product-item">
        <div class="flex items-center justify-center max-h-[300px]">
          <img
            src={product.image}
            alt={product.name}
            class="size-full object-contain  m-auto"
          />
        </div>

        <div>
          <div class="md:flex justify-between gap-8">
            <div>
              <h2 class="text-2xl font-black italic uppercase mb-6 mt-6 md:mt-0">
                {product.name}
              </h2>
              <p class="mb-8 text-lg">
                {currentLocale === "es"
                  ? product.description_es
                  : product.description}
              </p>
            </div>

            <p class="text-lg text-right text-[28px] leading-none flex-none">
              {product.price || "--"}â‚¬ <span class="text-[21px]">+ IVA</span>
              <br />
              /day
            </p>
          </div>

          <div class="flex items-end md:items-center justify-between gap-4 -translate-y-7">
            <Button
              tag="a"
              href={
                getRelativeLocaleUrl(currentLocale ?? "es", `/contact`) +
                `?product=${product.name}`
              }
            >
              {t.RENTAL.BUTTON}
            </Button>

            <span class="relative group cursor-pointer z-40 mt-6 hidden md:inline-block">
              <span class="text-2xl">
                <svg
                  width="32"
                  height="32"
                  viewBox="0 0 32 32"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <rect x="0.5" y="0.5" width="31" height="31" fill="white" />
                  <rect
                    x="0.5"
                    y="0.5"
                    width="31"
                    height="31"
                    stroke="#CCCCCC"
                  />
                  <path
                    d="M14.3344 22.8512V13.3824H17.08V22.8512H14.3344ZM15.7072 12.0624C15.2027 12.0624 14.792 11.9157 14.4752 11.6224C14.1584 11.3291 14 10.9653 14 10.5312C14 10.0971 14.1584 9.73333 14.4752 9.44C14.792 9.14667 15.2027 9 15.7072 9C16.2117 9 16.6224 9.1408 16.9392 9.4224C17.256 9.69227 17.4144 10.0443 17.4144 10.4784C17.4144 10.936 17.256 11.3173 16.9392 11.6224C16.6341 11.9157 16.2235 12.0624 15.7072 12.0624Z"
                    fill="#CCCCCC"
                  />
                </svg>
              </span>
              <div class="absolute right-full -bottom-8 transform mr-2 w-[80vw] max-w-[600px] bg-white text-gray-800 p-8 border border-gray-200 rounded-lg shadow-lg opacity-0 pointer-events-none transition-opacity duration-200 group-hover:opacity-100 group-hover:pointer-events-auto">
                <h3 class="font-bold mb-2">{t.RENTAL.SPECS}</h3>
                <ul>
                  {currentLocale === "es"
                    ? product.specs_es.map((spec) => (
                        <li class="mb-2">{spec}</li>
                      ))
                    : product.specs.map((spec) => <li class="mb-2">{spec}</li>)}
                </ul>
              </div>
            </span>
          </div>
        </div>
      </div>
    ))
  }
</section>
